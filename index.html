function createRoom() {
            const code = Math.random().toString(36).substring(2, 8).toUpperCase();
            alert("Room Code: " + code);
            toggleChatView(true);
            document.getElementById('chat-partner-name').innerText = "Room Created";
            document.getElementById('chat-status-text').innerText = "Share Code: " + code;
            if(!myProfile) setTimeout(() => { if(!myProfile) document.getElementById('identity-popup').classList.remove('hidden'); }, 60000);
        }

        function promptJoin() {
            const code = prompt("Enter 6-digit Code:");
            if(code) { openRecentChat(code.toUpperCase()); }
        }

        function handleAdvancedAction(type) {
            if(!myProfile) return document.getElementById('identity-popup').classList.remove('hidden');
            const id = document.getElementById('search-id').value.toUpperCase().trim();
            if(id) openRecentChat(id);
        }

        function emitTyping() {
            if(conn && conn.open) {
                conn.send({type: 'typing', isTyping: true});
                clearTimeout(typingTimeout);
                typingTimeout = setTimeout(() => conn.send({type: 'typing', isTyping: false}), 2000);
            }
        }
    </script>
</body>
</html>
